# DNS 域名系统

域名系统（英语：Domain Name System，缩写：DNS）是互联网的一项服务。  
它作为将域名和 IP 地址相互映射的一个分布式数据库，能够使人更方便地访问互联网。  
DNS 使用 TCP 和 UDP 端口 53[1]。  
当前，对于每一级域名长度的限制是 63 个字符，域名总长度则不能超过 253 个字符。

## 记录类型

1. 主机记录（A 记录）：A 记录是用于名称解析的重要记录，它将特定的主机名映射到对应主机的 IP 地址上。
2. IPv6 主机记录（AAAA 记录）:与 A 记录对应，用于将特定的主机名映射到一个主机的 IPv6 地址。
3. 别名记录（CNAME 记录）：CNAME 记录用于将某个别名指向到某个 A 记录上，这样就不需要再为某个新名字另外创建一条新的 A 记录。
4. 服务位置记录（SRV 记录）: 用于定义提供特定服务的服务器的位置，如主机（hostname），端口（port number）等。
5. 域名服务器记录（NS 记录） : 用来指定该域名由哪个 DNS 服务器来进行解析。
6. NAPTR 记录：提供正则表达式方式去映射一个域名。NAPTR 记录非常著名的一个应用是用于 ENUM 查询。

## 域名解析

DNS 查询有两种方式：递归和迭代。  
DNS 客户端设置使用的 DNS 服务器一般都是递归服务器，它负责全权处理客户端的 DNS 查询请求，直到返回最终结果。  
而 DNS 服务器之间一般采用迭代查询方式。

以查询 www.baidu.com 为例：

1. 客户端发送查询报文"query www.baidu.com"至 DNS 服务器，DNS 服务器首先检查自身缓存，如果存在记录则直接返回结果。
2. 如果记录老化或不存在，则：
3. DNS 服务器向根域名服务器发送查询报文"query www.baidu.com"，根域名服务器返回顶级域 .com 的顶级域名服务器地址。
4. DNS 服务器向 .com 域的顶级域名服务器发送查询报文"query www.baidu.com"，得到二级域 .baidu.com 的权威域名服务器地址。
5. DNS 服务器向 .baidu.com 域的权威域名服务器发送查询报文"query www.baidu.com"，得到主机 zh 的 A 记录，存入自身缓存并返回给客户端。
